pipeline {
    agent any
    environment {
        GOOGLE_CREDENTIALS = credentials('jenkins-service-gcp')
    }
    stages {
        stage('Setting Up') {
            steps {
                sh '''
                gcloud version
                gcloud auth activate-service-account --key-file=$GOOGLE_CREDENTIALS
                terraform --version  
                '''
            }
        }
    stage('Deploy Infrastructure'){
        step(
            'Deploying on GCP using Terraform' {
                sh '''
                terraform apply
                '''
            }
        )
    }
    }
}